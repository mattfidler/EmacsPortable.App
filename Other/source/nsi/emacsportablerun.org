#+TITLE: Emacs Portable Run Command
#+AUTHOR: Matthew L. Fidler
#+PROPERTY: tangle emacsportablerun.nsi
* Introduction
I found that Windows 7 doesn't like the autohotkey scripts to run
emacs.  Therefore, I have changed it to a NSIS command to see if it
works better....
* Launcher Properties
** Setup Options
I want:
 - user level execution
 - CRC check
 - Good compression
#+BEGIN_SRC nsis
CRCCheck On
RequestExecutionLevel user
; Best Compression
SetCompress Auto
SetCompressor /SOLID lzma
SetCompressorDictSize 32
SetDatablockOptimize On
Caption "Loading EmacsPortable.App"
Subcaption 3 " "
XPStyle on
OutFile "..\..\..\App\eps\run.exe"
Icon "..\img\ico\appicon.ico"
UninstallIcon "..\img\ico\trash_empty.ico"
!include "LogicLib.nsh"
!include "FileFunc.nsh"
!include "XML.nsh"
var EPEXE
var XML
var cmdLineParams
#+END_SRC
** User Interface
EmacsPortable.App uses the loading bar to startup emacs.
#+BEGIN_SRC nsis 
  AutoCloseWindow true
  SilentInstall silent
#+END_SRC


* Main
#+BEGIN_SRC nsis
  Section "Main" sec_main
    HideWindow
    ${GetParameters} $cmdLineParams
    execDos::exec '$cmdLineParams'
  SectionEnd
#+END_SRC
