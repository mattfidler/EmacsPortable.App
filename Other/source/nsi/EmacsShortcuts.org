#+TITLE: EmacsPortable.App NSIS Shortcuts
#+AUTHOR: Matthew L. Fidler
* Introtuction
These are emacs shortcuts for EmacsPortable.App specific options
** Basic Code
#+name: shortcut(output = "default", icon = "appicon", switch = "")
#+BEGIN_SRC emacs-lisp 
  (progn (with-temp-file (concat "./" output ".nsi")
    (insert (format "SetCompress Auto
  SetCompressor /SOLID lzma
  SetCompressorDictSize 32
  SetDatablockOptimize On
  Icon \"..\\img\\ico\\%s.ico\"
  OutFile \"..\\..\\..\\%s.exe\"
  
  CRCCheck On
  WindowIcon Off
  SilentInstall Silent
  AutoCloseWindow True
  RequestExecutionLevel user
  
  Section 
    Exec '\"$EXEDIR\\EmacsPortableApp.exe\" %s'
  SectionEnd" icon output switch)))
         (concat "./" output ".nsi"))
#+END_SRC
** Dos Mode
#+call: shortcut(output = "EmacsDos",icon="Gnome-terminal-non-nuvola",switch="/DOS")

#+results: shortcut(output = "EmacsDos",icon="Gnome-terminal-non-nuvola",switch="/DOS")
: ./EmacsDos.nsi

** Emacs -Q
#+call: shortcut(output = "Emacs-Q",icon="kbugbuster",switch="/Q")

#+results: shortcut(output = "Emacs-Q",icon="kbugbuster",switch="/Q")
: ./Emacs-Q.nsi


** Emacs Debugger 
#+call: shortcut(output = "EmacsDebug",icon="kbugbuster",switch="/DEBUG")

#+results: shortcut(output = "EmacsDebug",icon="kbugbuster",switch="/DEBUG")
: ./EmacsDebug.nsi

